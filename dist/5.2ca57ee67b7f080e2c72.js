webpackJsonp([5],{13:function(e,t,a){"use strict";function r(e){a(232)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(202),s=a.n(o);for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);var n=a(234),l=a(1),p=r,u=l(s.a,n.a,!1,p,null,null);t.default=u.exports},202:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(20),s=r(o),i=a(2),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(i),l=a(53),p=r(l);t.default={name:"profile",data:function(){var e=this,t=function(t,a,r){a!==e.form.password?r(new Error(e.$t("p.profile.validateError"))):r()};return{visible:!1,language:this.$ls.get("locale")||"zh-CN",languageList:p.default.list,uploadAPI:s.default.APIPrefix+"/upload",form:{headImg:this.$store.state.user.headImg,nickName:this.$store.state.user.nickName,password:"",passwordCheck:""},rules:{passwordCheck:[{trigger:"blur",validator:t}]}}},computed:{uploadHeaders:function(){return{Authorization:"Bearer "+this.$store.state.user.token}}},methods:{handleFormatError:function(e){this.$Notice.warning({title:this.$tc("p.profile.formatError",1),desc:this.$tc("p.profile.formatError",2,{name:e.name})})},handleSuccess:function(e,t,a){this.form.headImg=e.data.path},update:function(){var e=this,t={nick_name:this.form.nickName,head_img:this.form.headImg.replace(/http(s)?:/,"")};this.form.password&&(t.password=this.form.password),this.$refs.form.validate(function(a){a&&n.u.update({data:t}).then(function(t){t.data.success&&(e.$ls.set("locale",e.language),e.$i18n.locale=e.language,e.$Modal.success({title:e.$tc("p.profile.updateSuccess",1),content:e.$tc("p.profile.updateSuccess",2),onOk:function(){e.$router.push("/log-out")}}))})})}}}},232:function(e,t,a){var r=a(233);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(152)("c30ae4d4",r,!0)},233:function(e,t,a){t=e.exports=a(151)(),t.push([e.i,".em-profile .avatar{width:100%;border-radius:4px;margin:5px 0;cursor:pointer}.em-profile .ivu-upload{width:100%}.em-profile__content{padding:80px 165px;margin-top:20px;width:100%;background:#fff;-webkit-box-shadow:0 2px 3px #eee;box-shadow:0 2px 3px #eee;border-radius:4px;margin-bottom:20px}",""])},234:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-profile"},[a("em-header",{attrs:{icon:"edit",title:e.$t("p.profile.header.title"),description:e.$t("p.profile.header.description")}}),a("em-keyboard-short"),a("Modal",{attrs:{title:e.$t("p.profile.modal.title"),width:"400"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.form.headImg,expression:"form.headImg"}],staticStyle:{width:"100%"},attrs:{src:e.form.headImg}})]),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.pageAnimated,expression:"pageAnimated"}],staticClass:"em-container"},[a("div",{staticClass:"em-profile__content"},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"18"}},[a("Form",{ref:"form",attrs:{"label-position":"top",model:e.form,rules:e.rules}},[a("Form-item",{attrs:{label:e.$t("p.profile.form.language")}},[a("Select",{model:{value:e.language,callback:function(t){e.language=t},expression:"language"}},e._l(e.languageList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("Form-item",{attrs:{label:e.$t("p.profile.form.nickName")}},[a("i-input",{model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1),a("Form-item",{attrs:{label:e.$t("p.profile.form.password")}},[a("i-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("Form-item",{attrs:{label:e.$t("p.profile.form.passwordCheck"),prop:"passwordCheck"}},[a("i-input",{attrs:{type:"password"},model:{value:e.form.passwordCheck,callback:function(t){e.$set(e.form,"passwordCheck",t)},expression:"form.passwordCheck"}})],1),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:e.update}},[e._v(e._s(e.$t("p.profile.form.update")))])],1)],1)],1),a("Col",{attrs:{span:"6"}},[a("p",[e._v(e._s(e.$t("p.profile.form.avatar")))]),a("img",{directives:[{name:"show",rawName:"v-show",value:e.form.headImg,expression:"form.headImg"}],staticClass:"avatar",attrs:{src:e.form.headImg,alt:e.form.nickName,title:e.form.nickName},on:{click:function(t){e.visible=!0}}}),a("Upload",{attrs:{"show-upload-list":!1,format:["jpg","jpeg","png"],"on-success":e.handleSuccess,headers:e.uploadHeaders,"on-format-error":e.handleFormatError,action:e.uploadAPI}},[a("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline",long:""}},[e._v(e._s(e.$t("p.profile.form.upload")))])],1)],1)],1)],1)])])],1)},o=[],s={render:r,staticRenderFns:o};t.a=s}});