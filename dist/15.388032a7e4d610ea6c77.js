webpackJsonp([15],{180:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e};r.default={name:"ParamsBody",props:{initParams:[Array,Object]},data:function(){var e=this;this.$createElement;return{originData:[],paramsType:[{label:"string",value:"string"},{label:"number",value:"number"},{label:"integer",value:"integer"},{label:"boolean",value:"boolean"},{label:"array",value:"array"},{label:"object",value:"object"}],requiredType:[{label:"必须",value:"true"},{label:"非必须",value:"false"}],columns:[{key:"name",width:100,render:function(r,t){return e.renderName(r,t)}},{key:"others",render:function(r,t){return r("div",null,[e.renderType(r,t),e.renderRequired(r,t),e.renderDescription(r,t),e.renderSub(r,t)])}},{key:"operate",width:65,align:"center",render:function(r,t){var a=t.row,i=void 0===a?{}:a,n=i.type||i.schema&&i.schema.type,s="object"===n||"array"===n,p=i.schema;return p&&"object"===p.type&&p.properties&&Object.keys(p.properties).length>0&&(s=!1),p&&"array"===p.type&&p.items&&(p.items.properties&&Object.keys(p.items.properties).length>0?s=!1:p.items.type&&-1===["object","array"].indexOf(p.items.type)&&(s=!1)),r("Button-group",{attrs:{size:"small",vertical:!0}},[r("i-button",{attrs:{type:"ghost",icon:"ivu-icon ivu-icon-plus"},on:{click:e.addSibling.bind(e,t.index,t.row.name)}},["同级"]),s?r("i-button",{attrs:{type:"ghost",icon:"ivu-icon ivu-icon-plus"},on:{click:e.addChild.bind(e,t.index,t.row.name)}},["子级"]):null,r("i-button",{attrs:{type:"ghost",small:!0,icon:"ivu-icon ivu-icon-trash-b"},on:{click:e.deleteParam.bind(e,t.index,t.row.name)}},["删除"])])}}]}},computed:{resultData:function(){var e=this.initParams;if(!e)return[];if(this.originData=JSON.parse(JSON.stringify(this.initParams)),e instanceof Array)return e.map(function(e){return a({},e)});var r=e.properties,t=e.items,i=e.required;!r&&t&&(r=t.properties,i=t.required);var n=[];for(var s in r)n.push(a({name:s},r[s],{required:i&&i.length>0&&i.indexOf(s)>-1}));return n}},methods:{deleteParam:function(e,r){var t=this.originData;if(t instanceof Array)t.splice(e,1);else if("object"===t.type||"array"===t.type){var a=t.properties,i=t.required,n=t.items;"array"===t.type&&(a=n.properties,i=n.required),delete a[r];var s=i.indexOf(r);s>-1&&i.splice(s,1)}this.$emit("update",t)},addSibling:function(e){var r="参数"+Math.random().toString(36).substring(4),t=this.originData;t instanceof Array?t.splice(e+1,0,{name:r,type:"string",required:!1}):t.properties?(!t.properties&&(t.properties={}),t.properties[r]={type:"string"}):t.items&&(!t.items.properties&&(t.items.properties={}),t.items.properties[r]={type:"string"}),this.$emit("update",t)},addChild:function(e,r){var t="param_"+Math.random().toString(36).substring(4),a="string",i=this.originData;if(i instanceof Array){var n=i[e];"array"===n.type&&(delete n.items,n.schema={type:"array",items:{type:a}}),n.schema&&"array"===n.schema.type&&(n.schema.items||(n.schema.items={}),n.schema.items.properties||(n.schema.items.properties={}),n.schema.items.properties[t]={type:a}),n.schema&&"object"===n.schema.type&&(n.schema.properties||(n.schema.properties={}),n.schema.properties[t]={type:a})}else if("object"===i.type||"array"===i.type){var s=i;"array"===i.type&&(s=i.items),s.properties[r].schema||(s.properties[r].schema={}),s.properties[r].schema.properties||(s.properties[r].schema.properties={}),s.properties[r].schema.properties[t]={type:a}}this.$emit("update",i)},paramChange:function(e,r,t,i){var n=i.oldVal,s=i.propKey,p=this.originData,o=t;if("required"===r&&(o="true"===t),p instanceof Array){var l=p[e];"type"===r?"object"===o?(l.schema={type:o},delete l.type):"array"===o?(l.schema={type:o,items:{type:"string"}},delete l.type):(l[r]=o,delete l.schema,delete l.items):"arrType"===r?("array"===l.type&&(l.items.type=o),l.schema&&"array"===l.schema.type&&(l.schema.items={type:o})):l[r]=o}else if(p.properties||p.items){var u=p;if(p.items&&(u=p.items),"name"===r){u.properties[o]=a({},u.properties[n]),delete u.properties[n];var c=u,m=c.required,d=void 0===m?[]:m,y=d.indexOf(n);y>-1&&d.splice(y,1,o)}else if("required"===r){u.required=u.required||[];var h=u.required,v=h.indexOf(s);o&&-1===v&&u.required.push(s),!o&&v>-1&&u.required.splice(v,1)}else"type"===r&&"array"===o?(delete u.properties[s].schema,u.properties[s][r]=o,u.properties[s].items={type:"string"}):"type"===r&&"object"===o?(delete u.properties[s].items,delete u.properties[s].type,u.properties[s].schema={type:o,properties:{}}):"arrType"===r?("array"===u.properties[s].type&&(u.properties[s].items={type:o}),u.properties[s].schema&&"array"===u.properties[s].schema.type&&(u.properties[s].schema.items={type:o})):u.properties[s][r]=o}this.$emit("update",p)},renderName:function(e,r){var t=this;return e("Input",{props:{type:"text",value:r.row.name},on:{"on-blur":function(e){var a=e.target.value||"",i=r.row.name||"";a!==r.row.name&&t.paramChange(r.index,"name",a,{oldVal:i})}}})},renderType:function(e,r){var t=this,a=r.row,i=a.type,n=a.schema,s=a.items,p=i||n&&n.type||s&&s.type,o="";return"array"===i&&s&&(o=s.type),n&&"array"===n.type&&n.items&&(o=n.items.type),e("div",{class:"inline-select"},[e("div",{class:"select-btn"},[e("span",null,[this.$t("p.detail.expand.columnsRequest[3]")])]),e("i-select",{attrs:{size:"small",value:p},on:{change:function(e){return t.paramChange(r.index,"type",e,{propKey:r.row.name})},input:function(e){return t.paramChange(r.index,"type",e,{propKey:r.row.name})}}},[this.paramsType.map(function(r){return e("i-option",{key:r.value,attrs:{label:r.label,value:r.value}},[])})]),"array"===p?e("i-select",{attrs:{size:"small",value:o},on:{change:function(e){return t.paramChange(r.index,"arrType",e,{propKey:r.row.name})},input:function(e){return t.paramChange(r.index,"arrType",e,{propKey:r.row.name})}}},[this.paramsType.map(function(r){return e("i-option",{key:r.value,attrs:{label:r.label,value:r.value}},[])})]):null])},renderRequired:function(e,r){var t=this;return e("div",{class:"inline-select"},[e("div",{class:"select-btn"},[e("span",null,[this.$t("p.detail.expand.columnsRequest[4]")])]),e("i-select",{attrs:{size:"small",value:r.row.required?"true":"false"},on:{change:function(e){return t.paramChange(r.index,"required",e,{propKey:r.row.name})},input:function(e){return t.paramChange(r.index,"required",e,{propKey:r.row.name})}}},[this.requiredType.map(function(r){return e("i-option",{key:r.value,attrs:{label:r.label,value:r.value}},[])})])])},renderDescription:function(e,r){var t=this;return e("Input",{props:{type:"text",size:"small",value:r.row.description},on:{"on-blur":function(e){var a=e.target.value||"";a!==(r.row.description||"")&&t.paramChange(r.index,"description",a,{propKey:r.row.name})}}},[e("span",{slot:"prepend",props:{}},this.$t("p.detail.expand.columnsRequest[1]"))])},renderSub:function(e,r){var t=this,i=r.row,n=i.schema;if(n&&(n.properties&&Object.keys(n.properties).length>0||n.items&&n.items.properties&&Object.keys(n.items.properties).length>0))return e("ParamsBody",{props:{initParams:a({},n)},on:{update:function(e){t.paramChange(r.index,"schema",e,{oldVal:n,propKey:r.row.name})}}})}}}},186:function(e,r,t){"use strict";var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"params-table-wrapper"},[t("Table",{staticClass:"params-table",attrs:{columns:e.columns,data:e.resultData,"show-header":!1}})],1)},i=[],n={render:a,staticRenderFns:i};r.a=n},42:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t(180),i=t.n(a);for(var n in a)"default"!==n&&function(e){t.d(r,e,function(){return a[e]})}(n);var s=t(186),p=t(1),o=p(i.a,s.a,!1,null,null,null);r.default=o.exports}});